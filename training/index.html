
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../all_caps_data/">
      
      
        <link rel="next" href="../using_custom_model/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>6. Training Capfinder - Capfinder</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#training-the-capfinder-classifier" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Capfinder" class="md-header__button md-logo" aria-label="Capfinder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Capfinder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Training Capfinder
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/adnaniazi/capfinder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Capfinder" class="md-nav__button md-logo" aria-label="Capfinder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Capfinder
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/adnaniazi/capfinder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0. Graphical overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mRNA_sample_prep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. mRNA Sample Preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Data Preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Cap Prediction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Training for New Caps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Training for New Caps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0. Graphical overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oligo_design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Designing Cap Oligo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequencing_and_basecalling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Sequencing and Basecalling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extend_capmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Extending Cap Mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extract_train_signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Extracting Cap Signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../all_caps_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Making Training Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    6. Training Capfinder
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6. Training Capfinder
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#training-pipeline-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Training Pipeline Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Pipeline Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-etl-stage" class="md-nav__link">
    <span class="md-ellipsis">
      1. ETL Stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-tuning-stage" class="md-nav__link">
    <span class="md-ellipsis">
      2. Tuning Stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-training-stage" class="md-nav__link">
    <span class="md-ellipsis">
      3. Training Stage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-your-comet-ml-api-key" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up your COMET ML API Key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up your COMET ML API Key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-set-up-comet-ml" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Set Up COMET ML:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-training-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Training Configuration File
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-training-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Training Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-file-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration File Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#etl-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      ETL Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuning-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Tuning Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Training Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-rate-scheduler-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Rate Scheduler Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Mode
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Important Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using_custom_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Using Custom Trained Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../updating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Updating Capfinder
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Capfinder's Python API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Our Contributors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#training-pipeline-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Training Pipeline Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Pipeline Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-etl-stage" class="md-nav__link">
    <span class="md-ellipsis">
      1. ETL Stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-tuning-stage" class="md-nav__link">
    <span class="md-ellipsis">
      2. Tuning Stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-training-stage" class="md-nav__link">
    <span class="md-ellipsis">
      3. Training Stage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-your-comet-ml-api-key" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up your COMET ML API Key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up your COMET ML API Key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-set-up-comet-ml" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Set Up COMET ML:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-training-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Training Configuration File
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-training-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Training Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-file-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration File Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#etl-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      ETL Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuning-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Tuning Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Training Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-rate-scheduler-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Rate Scheduler Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Mode
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Important Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="training-the-capfinder-classifier">Training the Capfinder Classifier</h1>
<p>Now that we have cap signal data for all cap types, we're ready to train the classifier using our training pipeline. This process consists of three main stages: ETL (Extract, Transform, Load), Hyperparameter Tuning, and Final Training. Each stage plays a crucial role in developing an accurate and efficient classifier.</p>
<h2 id="training-pipeline-overview">Training Pipeline Overview</h2>
<ol>
<li><strong>ETL Stage</strong>: Prepares the cap signal data for training.</li>
<li><strong>Tuning Stage</strong>: Determines optimal hyperparameters for the chosen model.</li>
<li><strong>Training Stage</strong>: Trains the final model using the best hyperparameters.</li>
</ol>
<p>Let's delve into each stage in detail:</p>
<h3 id="1-etl-stage">1. ETL Stage</h3>
<p>The ETL stage is crucial for preparing our cap signal data, which is in the form of time series, for training. Here's what happens:</p>
<ul>
<li><strong>Signal Processing</strong>: Each signal is either truncated or zero-padded to a uniform length, which we call <code>target_length</code>. We typically set this to 500 data points.</li>
<li><strong>Balanced Dataset Creation</strong>: <code>examples_per_class</code> controls sample size per class for a balanced dataset. When specified, it selects that many examples from each class. If <code>null</code>, it automatically uses the size of the smallest class for all classes, ensuring equal representation and preventing bias in model training.</li>
<li><strong>Batched Loading</strong>: Data is loaded into memory in class-balanced batches, controlled by the <code>batch_size</code> parameter. This approach allows us to handle cap signal files larger than available memory.</li>
<li><strong>Batch Size Considerations</strong>: We recommend a batch size of 1024 or higher for efficiency. However, if you encounter GPU memory issues (indicated by a <code>Killed</code> message during hyperparameter tuning), try lowering the batch size. Some models, like the <code>encoder</code> type, are large and may require powerful GPUs and smaller batch sizes (as low as 16).</li>
<li><strong>Data Augmentation</strong>: Users can set <code>use_augmentation</code> to add time warped versions of traning data during data.  When <code>True</code>, it adds two versions (squished and expanded) of each original training example, applying random warping between 0-20%. This triples the training set size and increases tuning and training time by approximately 3x. The augmentation enhances classifier robustness to RNA translocation speed variations, potentially improving classification accuracy. Users should weigh the increased training time against potential performance benefits when deciding to use this option.</li>
<li><strong>Data Versioning</strong>: On the first run, the ETL stage creates train and test datasets, automatically versions them, and uploads them to Comet ML. This requires a valid Comet ML API key (free for academic users). Subsequent runs can load this preprocessed dataset, which is faster than reprocessing the original CSV files.</li>
</ul>
<h3 id="2-tuning-stage">2. Tuning Stage</h3>
<p>The tuning stage is where we optimize the hyperparameters of our chosen deep learning model:</p>
<ul>
<li><strong>Model Selection</strong>: You can choose from several model types: <code>attention_cnn_lstm</code>, <code>cnn_lstm</code>, <code>encoder</code>, <code>resnet</code>. The <code>encoder</code> model is the most computationally demanding, while <code>cnn_lstm</code> is the least demanding and is our default pretrained model due to its simplicity and speed.</li>
<li><strong>Hyperparameter Optimization</strong>: This stage uses techniques to find the best hyperparameter values. You can choose the optimization strategy from Random Search (<code>random_search</code>), Bayesian optimization (<code>bayesian_optimization</code>), or Hyperband (<code>hyperband</code>) using the <code>tuning_strategy</code> parameter in the configuration file.</li>
<li><strong>Comet ML Integration</strong>: A Comet ML experiment (specified by <code>comet_project_name</code> in the tune parameters) tracks performance metrics during tuning and logs the best hyperparameters.</li>
<li><strong>Flexibility</strong>: You can cancel the tuning stage at any time using CTRL+C. The best hyperparameters found up to that point will be used for the final training in the thrid stage.</li>
<li><strong>Epoch Strategy</strong>: It's often best to keep the number of epochs low during tuning to explore more parameter combinations. The most promising hyperparameters usually show good performance early on.</li>
</ul>
<h3 id="3-training-stage">3. Training Stage</h3>
<p>After finding the best hyperparameters, we proceed to the final training stage:</p>
<ul>
<li><strong>Extended Training</strong>: We use the best hyperparameters to train the model for a longer duration, allowing it to reach its performance plateau.</li>
<li><strong>Adaptive Stopping</strong>: Capfinder includes mechanisms to automatically stop training when performance ceases to improve. It then loads the weights from the most promising epoch.</li>
<li><strong>Model Evaluation</strong>: The final trained model is tested on a held-out test set, providing an unbiased assessment of its performance.</li>
<li><strong>Result Logging</strong>: Performance metrics and a confusion matrix are logged in Comet ML and the log file.</li>
<li><strong>Model Saving</strong>: The final model weights are saved in .keras format for future use.</li>
</ul>
<h2 id="setting-up-your-comet-ml-api-key">Setting up your COMET ML API Key</h2>
<p>Before initiating any training process, it's essential to set up your COMET ML account and API key. This allows Capfinder to log experiments, track metrics, and store models.</p>
<h3 id="steps-to-set-up-comet-ml">Steps to Set Up COMET ML:</h3>
<ol>
<li>
<p><strong>Create an Account</strong>:</p>
<ul>
<li>Visit <a href="https://www.comet.com/site/pricing/">COMET ML</a></li>
<li>Sign up for an account (Free tier is available for individual use)</li>
</ul>
</li>
<li>
<p><strong>Generate API Key</strong>:</p>
<ul>
<li>Once logged in, navigate to your account settings</li>
<li>Look for the "API Keys" section</li>
<li>Generate a new API key</li>
</ul>
</li>
<li>
<p><strong>Export API Key</strong>:</p>
<ul>
<li>After generating the API key, you need to make it available to Capfinder</li>
<li>Export it as an environment variable in your terminal</li>
</ul>
</li>
</ol>
<h3 id="example-command">Example Command:</h3>
<p>To export your COMET ML API key, use the following command in your terminal:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">COMET_API_KEY</span><span class="o">=</span><span class="s2">&quot;your-api-key-here&quot;</span>
</span></code></pre></div>
<h2 id="creating-a-training-configuration-file">Creating a Training Configuration File</h2>
<p>Before running the training pipeline, you need to create a JSON configuration file. Use the following command to generate a template:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>capfinder<span class="w"> </span>create-train-config<span class="w"> </span>--file_path<span class="w"> </span>/path/to/your/config.json
</span></code></pre></div>
</div>
<p>This will create a JSON file with default values. Edit this file to suit your specific needs.</p>
<h2 id="running-the-training-pipeline">Running the Training Pipeline</h2>
<p>Once you've customized your configuration file, start the training process with:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>capfinder<span class="w"> </span>train-model<span class="w"> </span>--config_file<span class="w"> </span>/path/to/your/config.json
</span></code></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Prematurely quiting hyperparameter tuning</p>
<p>Hyperparameter tuning takes a lot of time and will run until <code>max_trials</code> number of trials have been executed. If you are feeling impatient, or think that you have acheived good enough accuracy already, you can interrupt tuning by Pressing <code>CTRL+C</code> once at any time during tuning. The best hyperparameter upto that time point will used for the subsequent final classifier training.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Prematurely quiting final classifier training</p>
<p>The final classifier will be trained for multiple epochs as specified in the <code>max_epochs_final_model</code> setting. You can interrupt the final model training at any point in time by Pressing <code>CTRL+C</code> once. The models for the best epoch will be restored and this final model will be saved as as <code>.keras</code> file. It's weights will also be saved in an <code>.h5</code> file.</p>
</div>
<h2 id="configuration-file-parameters">Configuration File Parameters</h2>
<p>Let's break down the configuration file parameters:</p>
<h3 id="etl-parameters">ETL Parameters</h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">&quot;etl_params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="nt">&quot;use_remote_dataset_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nt">&quot;caps_data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/dir/&quot;</span><span class="p">,</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nt">&quot;examples_per_class&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">&quot;comet_project_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dataset&quot;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><code>use_remote_dataset_version</code>: Version of the remote dataset to use. Set to <code>""</code> to use/create a local dataset.</li>
<li><code>caps_data_dir</code>: Directory containing cap signal data files for all classes. This is the directory where all the <a href="../all_caps_data/">cap signal csv file for all the classes are stored</a></li>
<li><code>examples_per_class</code>: Maximum number of examples to use per class. If <code>null</code>, it automatically uses the size of the smallest class for all classes, ensuring equal representation and preventing bias in model training.</li>
<li><code>comet_project_name</code>: Name of the Comet ML project for dataset logging.</li>
</ul>
<h3 id="tuning-parameters">Tuning Parameters</h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">&quot;tune_params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="nt">&quot;comet_project_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capfinder_tune&quot;</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nt">&quot;patience&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="nt">&quot;max_epochs_hpt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="nt">&quot;max_trials&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="nt">&quot;factor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="nt">&quot;seed&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="nt">&quot;tuning_strategy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hyperband&quot;</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="nt">&quot;overwrite&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><code>comet_project_name</code>: Name of the Comet ML project for hyperparameter tuning.</li>
<li><code>patience</code>: Number of epochs with no improvement before stopping.</li>
<li><code>max_epochs_hpt</code>: Maximum epochs for each trial during tuning.</li>
<li><code>max_trials</code>: Maximum number of trials for hyperparameter search.</li>
<li><code>factor</code>: Reduction factor for Hyperband algorithm.</li>
<li><code>seed</code>: Random seed for reproducibility.</li>
<li><code>tuning_strategy</code>: Choose from "hyperband", "random_search", or "bayesian_optimization".</li>
<li><code>overwrite</code>: Whether to overwrite previous tuning results.</li>
</ul>
<h3 id="training-parameters">Training Parameters</h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">&quot;train_params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="nt">&quot;comet_project_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capfinder_train&quot;</span><span class="p">,</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nt">&quot;patience&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="nt">&quot;max_epochs_final_model&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><code>comet_project_name</code>: Name of the Comet ML project for model training.</li>
<li><code>patience</code>: Number of epochs with no improvement before stopping.</li>
<li><code>max_epochs_final_model</code>: Maximum epochs for training the final model.</li>
</ul>
<h3 id="shared-parameters">Shared Parameters</h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">&quot;shared_params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="nt">&quot;num_classes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nt">&quot;model_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cnn_lstm&quot;</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nt">&quot;batch_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="nt">&quot;target_length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="nt">&quot;dtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;float16&quot;</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="nt">&quot;train_test_fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="nt">&quot;train_val_fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="nt">&quot;use_augmentation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="nt">&quot;output_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/dir/&quot;</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><code>num_classes</code>: Number of classes in the dataset.</li>
<li><code>model_type</code>: Choose from "attention_cnn_lstm", "cnn_lstm", "encoder", "resnet".</li>
<li><code>batch_size</code>: Batch size for training. Adjust based on GPU memory.</li>
<li><code>target_length</code>: Target length for input sequences.</li>
<li><code>dtype</code>: Data type for model parameters. Options: "float16", "float32", "float64".</li>
<li><code>train_test_fraction</code>: Fraction of data to use for training vs. testing. Testing set is the holdout set.</li>
<li><code>train_val_fraction</code>: Fraction of training data to use for training vs. validation.</li>
<li><code>use_augmentation</code>: Whether to augment real training data with time-warped (squished and expanded) data</li>
<li><code>output_dir</code>: Directory to save output files.</li>
</ul>
<h3 id="learning-rate-scheduler-parameters">Learning Rate Scheduler Parameters</h3>
<p>The <code>lr_scheduler_params</code> section allows you to choose and configure one of three learning rate scheduling strategies. It's important to note that these schedulers are only used during the final training stage and not during hyperparameter tuning.</p>
<ol>
<li>
<p><strong>Reduce LR on Plateau (<code>reduce_lr_on_plateau</code>)</strong>:
    This scheduler reduces the learning rate when a metric has stopped improving. It's useful for fine-tuning the model in later stages of training.</p>
<ul>
<li><code>factor</code>: The factor by which the learning rate will be reduced (e.g., 0.5 means halving the learning rate).</li>
<li><code>patience</code>: Number of epochs with no improvement after which learning rate will be reduced.</li>
<li><code>min_lr</code>: Lower bound on the learning rate.</li>
</ul>
</li>
<li>
<p><strong>Cyclic Learning Rate (<code>cyclic_lr</code>)</strong>:
    This scheduler cyclically varies the learning rate between two boundaries. It can help the model to escape local minima and find better optima.</p>
<ul>
<li><code>base_lr</code>: Lower boundary of learning rate (initial learning rate).</li>
<li><code>max_lr</code>: Upper boundary of learning rate in the cycle.</li>
<li><code>step_size_factor</code>: Determines the number of iterations in a cycle.</li>
<li><code>mode</code>: The cycling mode (e.g., "triangular2" for a triangular cycle that decreases the cycle amplitude by half after each cycle).</li>
</ul>
</li>
<li>
<p><strong>Stochastic Gradient Descent with Restarts (SGDR) (<code>sgdr</code>)</strong>:
    This scheduler implements a cosine annealing learning rate schedule with periodic restarts. It can help the model to escape local minima and converge to a better optimum.</p>
<ul>
<li><code>min_lr</code>: Minimum learning rate.</li>
<li><code>max_lr</code>: Maximum learning rate.</li>
<li><code>lr_decay</code>: Factor to decay the maximum learning rate after each cycle.</li>
<li><code>cycle_length</code>: Number of epochs in the initial cycle.</li>
<li><code>mult_factor</code>: Factor to increase the cycle length after each full cycle.</li>
</ul>
</li>
</ol>
<p>Choose the scheduler type by setting the <code>type</code> parameter to one of "reduce_lr_on_plateau", "cyclic_lr", or "sgdr", and then configure the specific parameters for your chosen scheduler. Remember, these schedulers are applied only during the final training phase, not during hyperparameter tuning.</p>
<h3 id="debug-mode">Debug Mode</h3>
<p><div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nt">&quot;debug_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
</span></code></pre></div>
- Set to <code>true</code> to enable debug mode for more detailed logging.</p>
<h2 id="important-considerations">Important Considerations</h2>
<ol>
<li>
<p><strong>Batch Size</strong>: Start with a batch size of 1024 or higher. If you encounter memory issues, especially with larger models like "encoder", reduce the batch size.</p>
</li>
<li>
<p><strong>GPU Monitoring</strong>: Use commands like <code>nvidia-smi</code> to monitor GPU resources and adjust batch size accordingly.</p>
</li>
<li>
<p><strong>Comet ML</strong>: Ensure you have a valid Comet ML API key (free for academic users) for data versioning and experiment tracking.</p>
</li>
<li>
<p><strong>Model Types</strong>:</p>
<ul>
<li>"cnn_lstm": Simplest and fastest for training and inference. Achieves good accuracy.</li>
<li>"encoder": Most computationally demanding. We had very little success with this model</li>
<li>"attention_cnn_lstm" and "resnet": Intermediate in terms of computational requirements.</li>
</ul>
</li>
<li>
<p><strong>Hyperparameter Tuning</strong>: Can be interrupted at any time using CTRL+C. The best hyperparameters up to that point will be used for final training.</p>
</li>
<li>
<p><strong>Final Training</strong>: Uses the best hyperparameters to train the model for a longer duration, allowing it to reach performance plateau.</p>
</li>
<li>
<p><strong>Automatic Stopping</strong>: The training process will automatically stop when performance ceases to improve, loading the weights from the most promising epoch.</p>
</li>
<li>
<p><strong>Model Evaluation</strong>: The final model is tested on a held-out test set, providing an unbiased performance assessment.</p>
</li>
<li>
<p><strong>Output</strong>: Performance metrics, confusion matrix, and the final model (in .keras format) are saved and logged in Comet ML.</p>
</li>
</ol>
<p>By following this guide and adjusting the configuration parameters as needed, you can effectively train and evaluate your Capfinder classifier. The process is designed to be flexible, allowing you to balance between computational resources, time constraints, and model performance based on your specific requirements.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.tabs.link"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>